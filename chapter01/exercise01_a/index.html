<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="de">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>1. Datenstrukturen in 3D &amp; Godot Basics - Computergrafik MIB</title>

    
    <meta name="description" content="Online-Material zur Veranstaltung Computergrafik MIB.">
    
    <link rel="canonical" href="https://simonstorlschulke.github.io/chapter01/exercise01_a/">
    

    <meta property="og:url" content="https://simonstorlschulke.github.io/chapter01/exercise01_a/">
    <meta property="og:title" content="Computergrafik MIB">
    <meta property="og:image" content="https://simonstorlschulke.github.io/images/lecture_logo_dvmp.png">
    <meta name="apple-mobile-web-app-title" content="Computergrafik MIB">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://simonstorlschulke.github.io/images/lecture_icon.png">
    <link rel="icon" type="image/x-icon" href="https://simonstorlschulke.github.io/images/lecture_icon.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://simonstorlschulke.github.io/fonts/icon.eot?52m981');
        src: url('https://simonstorlschulke.github.io/fonts/icon.eot#iefix52m981')
               format('embedded-opentype'),
             url('https://simonstorlschulke.github.io/fonts/icon.woff?52m981')
               format('woff'),
             url('https://simonstorlschulke.github.io/fonts/icon.ttf?52m981')
               format('truetype'),
             url('https://simonstorlschulke.github.io/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://simonstorlschulke.github.io/stylesheets/application.css">
    <link rel="stylesheet" href="https://simonstorlschulke.github.io/stylesheets/temporary.css">
    <link rel="stylesheet" href="https://simonstorlschulke.github.io/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://simonstorlschulke.github.io/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <link rel="stylesheet" href="https://simonstorlschulke.github.io/stylesheets/custom.css">
    
    <script src="https://simonstorlschulke.github.io/javascripts/modernizr.js"></script>


  </head>
  <body class="palette-primary-indigo palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        1. Datenstrukturen in 3D &amp; Godot Basics
      </div>
    </div>

    

    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://simonstorlschulke.github.io//general" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://simonstorlschulke.github.io/images/lecture_logo_dvmp.png">
        </div>
      
      <div class="name">
        <strong>Computergrafik MIB </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    <span class="section">Allgemeines</span>
    <ul>
      
        
        



<a  title="Kursinfo" href="https://simonstorlschulke.github.io/general/">
	
	Kursinfo
</a>



      
        
        



<a  title="Links &amp; Literatur" href="https://simonstorlschulke.github.io/links/">
	
	Links &amp; Literatur
</a>



      
        
        



<a  title="Vorlesungs Pythonscripts" href="https://simonstorlschulke.github.io/course-python-scripts/">
	
	Vorlesungs Pythonscripts
</a>



      
    </ul>
  
</li>



<li>
  
    <span class="section">Kapitel</span>
    <ul>
      
        
        



<a class="current" title="1. Datenstrukturen in 3D &amp; Godot Basics" href="https://simonstorlschulke.github.io/chapter01/exercise01_a/">
	
	1. Datenstrukturen in 3D &amp; Godot Basics
</a>


<ul id="scrollspy">
</ul>


      
    </ul>
  
</li>


        </ul>
        

        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>1. Datenstrukturen in 3D &amp; Godot Basics </h1>

			<h2 id="datenstrukturen-in-3d---meshes">Datenstrukturen in 3D - Meshes</h2>
<p>Die wohl wichtigste Methode zur Repräsentation dreidimensionaler Objekte im Speicher eines Computers ist das Drahtgittermodell - englisch Mesh. Hierbei wird die Form eines Objektes approximiert, indem es aus Dreiecken modelliert wird.</p>
<p><img src="img/suzanne_mesh.png" alt="suzanne mesh">
<em>Das Maskottchen der 3D Software Blender als Drahtgittermodell aus Drei-, bzw Vierecken</em></p>
<p>Oft wird dem Nutzer von 3D Software auch ermöglicht Formen mit 4 oder noch mehr Eckpunkten zum modellieren zu verwenden, irgendwo auf dem Weg von der Benutzeroberfläche zur Grafikkarte werden diese jedoch immer wieder zu Dreiecken umgewandelt.</p>
<blockquote class="info">
    <p>Grafikkarten sind über die Jahre immer besser darin geworden große Mengen dieser Dreiecke darzustellen und Lichtsimulationen damit auszuführen. Effekte, die vor ein paar Jahren noch Filmen vorbehalten waren (bei denen jeder Frame Minuten bis Stunden für das Rendering braucht), sind in modernen Videospielen inzwischen in 120 Frames pro Sekunde möglich.</p>
<div class="tcl-row">
<div class="tcl-column tcl-left" style="width: 50%"><img src="img/finding_nemo.jpg" alt="">
<em>Findet Nemo (Film) 2003</em></div>
<div class="tcl-column tcl-right" style="width: 50%"><img src="img/subnautica.jpg" alt="">
<em>Subnautica (Videospiel) 2018</em></div>
</div>
</blockquote>
<p>Zur Art der Abspeicherung dieser Dreiecke gibt es verschiedene Herangehensweisen. Die einfachste ist es, einfach eine Liste an Punkten zu speichern,
die jeweils aus 3 Werten (x, y, z) bestehen.</p>
<p><img src="img/vertexlist.png" alt="vertex list"></p>
<p>Zur Optimierung des Renderings werden die Dreiecke meist nur aus einer Blickrichtung dargestellt (&ldquo;Backface Culling&rdquo;). Daher ist auch die Reihenfolge in der die Punkte gespeichert werden wichtig. Normalerweise gehen Renderengines davon aus, dass die Vorderansicht eines Dreiecks die ist, aus der die Eckpunkte der Reihenfolge nach im Uhrzeigersinn gespeichert sind.</p>
<p><strong>Vertex Indices</strong><br>
Letztere Methode funktioniert für einfache Objekte, hat jedoch den Nachteil, dass Eckpunkte (Vertices) die von mehreren Flächen verwendet werden für jede Fläche separat gespeichert werden müssen. Um Speicherplatz und Rechenleistung zu Optimieren wird meist mit sogenannten Vertex Indices gearbeitet.<br>
Dabei werden die Punkte wie zuvor ein einer Liste gespeichert, jedoch wird eine zusätzliche Liste angelegt, in der jeweils die Indices von drei (oder je nach Format auch mehr) dieser Punkte angegeben werden, die eine Fläche bilden.</p>
<p><img src="img/no_vertex_indices.png" alt="keine vertex indices">
<em>Darstellung eines Vierecks mit einer Liste von Punkten von denen jeweils drei ein Dreieck bilden</em></p>
<p><img src="img/vertex_indices.png" alt="vertex indices">
<em>Darstellung eines Vierecks mit einer Liste von Punkten und einer separaten liste (&ldquo;Faces&rdquo;), die angeben wie die Flächen zwischen den Punkten gespannt werden sollen</em></p>
<blockquote class="todo">
    Exportiert mit Blender eine 3D Datei mit nur einem einzigen sehr einfachem Objekt (Würfel) als &ldquo;Wavefront .obj&rdquo; Datei.
Ignoriert die erzeugte .mtl Datei (diese betrifft Materialien) und öffnet die .obj Datei in einem Texteditor.
Dieses Dateiformat ist so simpel, dass sich die einzelnen Vertices und Vertex indices einfach herauslesen lassen. Versucht anhand der <a href="https://de.wikipedia.org/wiki/Wavefront_OBJ">Spezifikation auf Wikipedia</a> herauszufinden, wie hier Vertices und Vertex Indices gespeichert sind.<br>
Normalen und Texturkoordinaten interessieren uns hier vorerst nicht
</blockquote>
<p><strong>Normalen</strong><br>
Nun da der Computer weiß, wo die Flächen eines Modells sein sollen, wird für die Berechnung der Beleuchtung einer Szene noch die Richtung benötigt, in die jeder Oberflächenpunkt &ldquo;zeigt&rdquo; - also der orthogonale Vektor zur Oberfläche. Auch hierfür gibt es verschiedene Herangehensweisen. z.B.:</p>
<ol>
<li>
<p>Die Normale wird gar nicht mit abgespeichert sondern für jedes Dreieck live anhand der Vertexpositionen berechnet. Dies hat den Vorteil, dass sich die 3D Software / das Speicherformat nicht um die Normalen kümmern muss. Die Renderengine benötigt dann jedoch mehr Rechenleistung.</p>
</li>
<li>
<p>Die Normalen werden für jede Fläche mit abgespeichert (wie z.B. im .obj Format)</p>
</li>
<li>
<p>Die Normalen werden nicht für jede Fläche, sondern für jeden Vertex mitgespeichert. Das hat den Vorteil, dass die Normalen auf der Fläche dann abhängig zur Distanz zu jedem Eckpunkt interpoliert werden können und somit auch Objekte mit wenig Punkten &ldquo;weich&rdquo; gezeichnet werden können.</p>
</li>
</ol>
<p><img src="img/shad-face-normals.png" alt="face normals vs vertex normals"><br>
<strong>Face Normals vs Vertex Normals</strong>
source: <a href="https://www.scratchapixel.com/images/shading-intro/shad-face-normals2.png">https://www.scratchapixel.com/images/shading-intro/shad-face-normals2.png</a>
<img src="img/facenormals_vertexnormals.png" alt="face normals vs vertex normals"><br>
Darstellung einer Kugel mit Face-Normals vs. &ldquo;Smooth Shading&rdquo; mithilfe interpolierter vertex normals</p>
<h2 id="erste-schritte">Erste Schritte</h2>
<p><strong>In dieser Übung wollen wir uns mit dem Setup und ersten Schritten mit Godot beschäftigen.</strong></p>
<blockquote class="todo">
    <ul>
<li>Ladet euch zunächst von <a href="https://godotengine.org/download">godotengine.org</a> die aktuelle Version von Godot herunter. Wir werden für diese Vorlesung nur die Standartversion der Engine (nicht .NET) benötigen.</li>
<li>Entpackt die .zip Datei.</li>
<li>Eine Installation ist nicht nötig. Die Engine kann nun mit der .exe Datei (die Datei ohne &ldquo;_console&rdquo; am Ende) gestartet werden.</li>
</ul>

</blockquote>
<p><em>Dieses Script behandelt die Version 4.2. Zukünftige Versionen könnten eventuell Änderungen vornehmen, normalerweise bleibt die API bei Updates jedoch großteils unverändert.</em></p>
<p><img src="img/godot_start.png" alt="Godot beim Start"></p>
<p>Die Engine öffnet sich</p>
<p><span class="counter">1</span> Der Szeneviewer dient der Vorschau in der 3D / 2D Szene und der transformation von Objekten.</p>
<p><span class="counter">2</span> In diesem Bereich kann die Szenenhierarchie überblickt und bearbeitet werden.</p>
<p><span class="counter">3</span> Im Inspector können die Eigenschaften des aktuell ausgewählte Objekts (Node*) bearbeitet werden.</p>
<p><span class="counter">4</span> Das &ldquo;FileSystem&rdquo; ist die tatsächliche Ordnerstruktur des Projekts. Hier werden Texturen, Modelle und Scripte gespeichert und verwaltet.</p>
<blockquote class="todo">
    <strong>freie Arbeit (45-60min)</strong><br>
Arbeite die Godot Dokumentation <a href="https://docs.godotengine.org/en/stable/tutorials/3d/procedural_geometry/index.html">&ldquo;Getting started&rdquo;</a> (oder <a href="https://docs.godotengine.org/de/4.x/getting_started/introduction/index.html">auf deusch</a>) durch oder mache dich anderweitig mit den Grundkonzepten von Godot bekannt. Die Sektion &ldquo;Your first 2D Game&rdquo; kann übersprungen werden, da wir uns hier ausschließlich mit der 3D Funktionalität von Godot beschäftigen werden.
</blockquote>
<h2 id="meshgenerierung-mit-godot">Meshgenerierung mit Godot</h2>
<p>Godot stellt uns viele mächtigere Tools zur Verfügung um in-code 3D Objekte zu generieren. Wir fangen hier nun mit der</p>
<p>Ein <a href="https://docs.godotengine.org/en/stable/classes/class_arraymesh.html">ArrayMesh</a>
in Godot wird aus einem Array erzeugt, bei dem jeder Eintrag ein weiterer Array ist. Der Aufbau ist ähnlich dem einer .obj Datei.<br>
Der erste Subarray enthält alle Vertexpositionen, der zweite die Vertexnormalen (in der selben Reihenfolge), dann folgen Texturcoordinaten etc.
Schließlich ist der 12. Subarray der Vertex-Indices Array, der bestimmt, zwischen welchen Punkten die Flächen gezogen werden sollen. Dieser ist optional - wird er nicht angegeben, werden wie oben die Dreiecke einfach der vorkommenden Reihenfolge nach gezogen.</p>
<p><a href="https://docs.godotengine.org/en/stable/classes/class_mesh.html#enum-mesh-arraytype">Siehe ArrayType</a></p>
<p><img src="img/arraymesh.png" alt="arraymesh"></p>
<blockquote class="todo">
    <p>Nutzt Godots ArrayMesh, um ein Mesh (eurer Wahl) zu generieren.</p>
<p><img src="img/armesh_todo_01.png" alt="Godot beim Start"><br>
Erzeugt dazu eine 3D Szene</p>
<p><img src="img/armesh_todo_02.png" alt="Godot beim Start">
Fügt dem Node3D als Kind einen <em>Meshinstance</em> Node hinzu</p>
<p><img src="img/armesh_todo_03.png" alt="Godot beim Start">
Fügt diesem nun ein script hinzu und gebt ihm folgenden Inhalt:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gdscript" data-lang="gdscript"><span class="line"><span class="ln">1</span><span class="cl"><span class="nd">@tool</span> <span class="c1"># ermöglicht es Skripte im Editor (ohne dass das Spiel gestartet werden muss) auszuführen</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="kd">extends</span> <span class="nc">MeshInstance3D</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="nd">@export</span> <span class="kd">var</span> <span class="n">regenerate_mesh</span><span class="p">:</span> <span class="kt">bool</span><span class="p">:</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">	<span class="nf">set</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">		<span class="nf">create_mesh</span><span class="p">()</span>
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="kd">func</span> <span class="nf">create_mesh</span><span class="p">():</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl">	<span class="k">pass</span></span></span></code></pre></div>
<p>Die genaue Funktion von Zeile 4-6 ist vorerst nicht wichtig - das sorgt nur dafür, dass ihr nun im 3D Editor wenn MeshInstance selektiert ist einen &ldquo;Regenerate Mesh&rdquo; Button rechts hat, der die Funktion <code>create_mesh()</code> ausführt.</p>
<p>Fügt nun euren Code in die Funktion <code>create_mesh()</code> ein. Hilfreich ist hier die <a href="https://docs.godotengine.org/en/stable/classes/class_arraymesh.html">Dokumentation zu ArrayMeshes</a>.</p>

</blockquote>


			<aside class="copyright" role="note">
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://simonstorlschulke.github.io/general/" title="Allgemeines">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              Allgemeines
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://simonstorlschulke.github.io/chapter02/exercise01_a/" title="">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="https://simonstorlschulke.github.io/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>


